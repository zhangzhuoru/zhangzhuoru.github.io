<!doctype html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <style type="text/css">
        html,
        body,
        h1,
        h2,
        h3,
        h4,
        h5,
        h6,
        p,
        blockquote,
        ol,
        ul,
        li,
        img {
            margin: 0;
            padding: 0;
            font-size: 100%;
            font: inherit;
            vertical-align: baseline;
        }
        
        html * {
            font-family: "ff-din-web-pro-1", "ff-din-web-pro-2", sans-serif;
            font-size: 16px;
            line-height: 19.2px;
            color-profile: sRGB;
        }
        
        body {
            min-width: 32em;
            max-width: 56em;
            margin: 10px auto;
        }
        
        p, blockquote p {
            line-height: 1.6;
        }
        
        ul, ol {
            margin: 16px 0;
        }
        
        ul li, ol li {
            line-height: 1.6;
        }
        
        p {
            font-weight: lighter;
            margin: 10px 0;
        }
        
        strong {
            font-weight: bold;
        }
        
        ol,
        ul {
            margin-left: 2em;
        }
        
        h1,
        h2,
        h3,
        h4,
        h5,
        h6 {
            font-weight: lighter;
            text-transform: capitalize;
            margin: 20px 0;
            border-bottom: 1px solid;
            padding-bottom: 6px;
        }
        
        h1, h1 > code {
            font-size: 24.624px;
            line-height: 29.548799999999996px;
        }
        
        h2, h2 > code {
            font-size: 24.624px;
            line-height: 29.548799999999996px;
        }
        
        h3, h3 > code {
            font-size: 23.44px;
            line-height: 28.128px;
        }
        
        h4, h4 > code {
            font-size: 22.16px;
            line-height: 26.592px;
        }
        
        h5, h5 > code {
            font-size: 22.16px;
            line-height: 26.592px;
        }
        
        h6, h6 > code {
            font-size: 22.16px;
            line-height: 26.592px;
        }
        
        img {
            margin-bottom: 20px;
        }
        
        h1 img,
        h2 img,
        h3 img,
        h4 img,
        h5 img,
        h6 img,
        p img {
            margin-bottom: 0;
        }
        
        pre,
        code {
            font-family: monospace, Consolas, "Source Code Pro", Arial, sans-serif;
            color: #586e75;
            background-color: #eee8d5;
        }
        
        pre {
            white-space: pre-wrap;
            word-wrap: break-word;
            padding: 12px;
            margin-bottom: 20px;
        }
        
        code {
            border-radius: 3px;
        }
        
        h1 {
            text-transform: uppercase;
            font-weight: bold;
        }
        
        h3,
        h4,
        h5,
        h6 {
            border-bottom: none;
        }
        
        html * {
            color: #657b83;
        }
        
        html body {
            background-color: #fdf6e3;
        }
        
        html h1,
        html h2,
        html h3,
        html h4,
        html h5,
        html h6 {
            color: #586e75;
            border-color: #657b83;
        }
        
        html a,
        html a:active,
        html a:visited {
            color: #586e75;
            text-decoration: none;
            border-bottom: 1px dashed;
            border-radius: 2px;
        }
        
        html a:hover {
            background-color: #eee8d5;
        }
        
        blockquote a:hover {
            background-color: #fdf6e3;
        }
        
        html a,
        html a:active,
        html a:visited,
        html code.url {
            color: #b58900;
        }
        
        html h1 {
            color: #b58900;
        }
        
        html h2,
        html h3,
        html h4,
        html h5,
        html h6 {
            color: #b58900;
        }
        
        /* QUOTES
        =============================================================================*/
        blockquote {
            border-left: 4px solid #b58900;
            padding: 12px;
            background: #eee8d5;
            border-bottom-right-radius: 2px;
        }
        
        blockquote code {
            background: #fdf6e3;
        }
        
        blockquote > :first-child {
            margin-top: 0;
        }
        
        blockquote > :last-child {
            margin-bottom: 0;
        }
        
        /* TABLES
        =============================================================================*/
        table {
            margin: 0 auto;
            border-collapse: collapse;
            width: 100%;
            box-sizing: border-box;
            margin-bottom: 30px;
        }
        
        table th, table td {
            border: 1px solid #ccc;
            padding: 6px 13px;
        }
        
        table td {
            word-break: break-word;
            line-height: 1.3;
        }
        
        table th {
            font-weight: bold;
            text-align: center !important;
            background-color: #eee8d5;
        }
        
        table tr {
            border-top: 1px solid #ccc;
            background-color: #fdf6e3;
        }
        
        /* IMAGES
        =============================================================================*/
        img {
            max-width: 100%;
        }
        
        p > img {
            display: table;
            margin: 0 auto;
        }
        
        p code, li code, td code {
            padding: 1px 3px;
            border-radius: 3px;
        }
        
        .cp_embed_wrapper {
            margin: 20px 0;
        }
        
        @media screen and (min-width: 980px) and (max-width: 980px) {	
            table thead tr th,
            table thead tr th > code,
            table tbody tr td,
            table tbody tr td > code,
            table tbody tr td > strong {
                font-size: 1.3em;
                line-height: 1.3;
            }
        
            p, p code,
            p strong, p strong > code,
            blockquote p {
                font-size: 1.3em;
                line-height: 1.6;
            }
        
            pre > code,
            ul li pre > code,
            ol li pre > code{
                font-size: 1.3em;
                line-height: 1.3;    	
            }	
            
        
            ul li, ol li,
            ul li > code,
            ol li > code {
                font-size: 1.3em;
                line-height: 1.3;          
            }
        
            ul {
                margin-left: 3.4em;
            }
        
            ol {
                margin-left: 3.6em;
            }
        }
        </style>
<title>05-retina屏幕1px边框问题</title></head>
<body><h1>7 种方法解决移动端 Retina 屏幕 1px 边框问题</h1>
<h3>造成边框变粗的原因</h3>
<p>其实这个原因很简单，因为css中的1px并不等于移动设备的1px，这些由于不同的手机有不同的像素密度。在window对象中有一个devicePixelRatio属性，他可以反应css中的像素与设备的像素比。</p>
<blockquote><p>devicePixelRatio的官方的定义为：设备物理像素和设备独立像素的比例，也就是 devicePixelRatio = 物理像素 / 独立像素。</p>
</blockquote>
<h3>解决边框变粗的6种办法</h3>
<h1>1、0.5px边框</h1>
<p>在2014年的 WWDC，“设计响应的Web体验” 一讲中，Ted O’Connor 讲到关于“retinahairlines”（retina 极细的线）：在retina屏上仅仅显示1物理像素的边框，开发者应该如何处理呢。</p>
<p>他们曾介绍到 iOS 8 和 OS X Yosemite 即将支持 0.5px 的边框：</p>
<p>&nbsp;</p>
<p><img src="https://user-gold-cdn.xitu.io/2016/12/12/f6ad282f2019bbbb30c9ac84902fcb02?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" referrerpolicy="no-referrer" alt="img"></p>
<p>0.5px边框</p>
<p>额的神呐！so easy! 果真如此吗？这样还不够（WWDC幻灯片通常是“唬人”的），但是相差不多。</p>
<p>问题是 retina 屏的浏览器可能不认识0.5px的边框，将会把它解释成0px，没有边框。包括 iOS 7 和之前版本，OS X Mavericks 及以前版本，还有 Android 设备。</p>
<p>&nbsp;</p>
<p><strong>解决方案：</strong>
解决方案是通过 JavaScript 检测浏览器能否处理0.5px的边框，如果可以，给html标签元素添加个class。</p>
<pre><code>if (window.devicePixelRatio &amp;&amp; devicePixelRatio &gt;= 2) {
var testElem = document.createElement(&#39;div&#39;);
testElem.style.border = &#39;.5px solid transparent&#39;;
document.body.appendChild(testElem);
if (testElem.offsetHeight == 1) {
document.querySelector(&#39;html&#39;).classList.add(&#39;hairlines&#39;);
}
document.body.removeChild(testElem);
}
// 脚本应该放在内，如果在里面运行，需要包装 $(document).ready(function() {})
</code></pre>
<p>然后，极细的边框样式就容易了：</p>
<pre><code>div {
border: 1px solid #bbb;
}
.hairlines div {
border-width: 0.5px;
}
</code></pre>
<p>&nbsp;</p>
<h2>2、使用border-image实现</h2>
<p>准备一张符合你要求的border-image：</p>
<p><img src="https://user-gold-cdn.xitu.io/2016/12/12/ca699bb52b53f3014edce2771051b6f2?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" referrerpolicy="no-referrer" alt="img"></p>
<p>底部边框</p>
<p>样式设置：</p>
<pre><code>.border-bottom-1px {
border-width: 0 0 1px 0;
-webkit-border-image: url(linenew.png) 0 0 2 0 stretch;
border-image: url(linenew.png) 0 0 2 0 stretch;
}
</code></pre>
<p>上文是把border设置在边框的底部，所以使用的图片是2px高，上部的1px颜色为透明，下部的1px使用视觉规定的border的颜色。如果边框底部和顶部同时需要border，可以使用下面的border-image：</p>
<p><img src="https://user-gold-cdn.xitu.io/2016/12/12/99a1fd3191a7c819f9ac6fa55811a816?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" referrerpolicy="no-referrer" alt="img"></p>
<p>上下边框</p>
<p>样式设置：</p>
<pre><code>.border-image-1px {
border-width: 1px 0;
-webkit-border-image: url(linenew.png) 2 0 stretch;
border-image: url(linenew.png) 2 0 stretch;
}
</code></pre>
<p>到目前为止，我们已经能在iphone上展现1px border的效果了。但是我们发现这样的方法在非视网膜屏上会出现border显示不出来的现象，于是使用Media Query做了一些兼容，样式设置如下：</p>
<pre><code class='language-css' lang='css'>.border-image-1px {
border-bottom: 1px solid #666;
}
@media only screen and (-webkit-min-device-pixel-ratio: 2) {
.border-image-1px {
border-bottom: none;
border-width: 0 0 1px 0;
-webkit-border-image: url(../img/linenew.png) 0 0 2 0 stretch;
border-image: url(../img/linenew.png) 0 0 2 0 stretch;
}
}
</code></pre>
<p><strong>缺点：</strong></p>
<ul>
<li>修改颜色麻烦, 需要替换图片</li>
<li>圆角需要特殊处理，并且边缘会模糊</li>

</ul>
<h3>3、使用background-image实现</h3>
<p>background-image 跟border-image的方法一样，你要先准备一张符合你要求的图片。然后将边框模拟在背景上。
样式设置：</p>
<pre><code>.background-image-1px {
background: url(../img/line.png) repeat-x left bottom;
-webkit-background-size: 100% 1px;
background-size: 100% 1px;
}
</code></pre>
<p><strong>优点：</strong></p>
<p><strong>缺点：</strong></p>
<ul>
<li>修改颜色麻烦, 需要替换图片</li>
<li>圆角需要特殊处理，并且边缘会模糊</li>

</ul>
<h3>4、多背景渐变实现</h3>
<p>与background-image方案类似，只是将图片替换为css3渐变。设置1px的渐变背景，50%有颜色，50%透明。
样式设置：</p>
<pre><code class='language-css' lang='css'>.background-gradient-1px {
background:
linear-gradient(180deg, black, black 50%, transparent 50%) top left / 100% 1px no-repeat,
linear-gradient(90deg, black, black 50%, transparent 50%) top right / 1px 100% no-repeat,
linear-gradient(0, black, black 50%, transparent 50%) bottom right / 100% 1px no-repeat,
linear-gradient(-90deg, black, black 50%, transparent 50%) bottom left / 1px 100% no-repeat;
}
/* 或者 */
.background-gradient-1px{
background: -webkit-gradient(linear, left top, left bottom, color-stop(.5, transparent), color-stop(.5, #c8c7cc), to(#c8c7cc)) left bottom repeat-x;
background-size: 100% 1px;
}
</code></pre>
<h3>5、使用box-shadow模拟边框</h3>
<p>利用css 对阴影处理的方式实现0.5px的效果
样式设置：</p>
<pre><code class='language-css' lang='css'>.box-shadow-1px {
box-shadow: inset 0px -1px 1px -1px #c8c7cc;
}
</code></pre>
<p><strong>优点：</strong></p>
<p><strong>缺点：</strong></p>
<h3>6、viewport + rem 实现</h3>
<p>同时通过设置对应viewport的rem基准值，这种方式就可以像以前一样轻松愉快的写1px了。
在devicePixelRatio = 2 时，输出viewport：</p>
<pre><code>在devicePixelRatio = 3 时，输出viewport：
​```html
</code></pre>
<p>这种兼容方案相对比较完美，适合新的项目，老的项目修改成本过大。
对于这种方案，可以看看<a href='https://github.com/amfe/article/issues/17'>《使用Flexible实现手淘H5页面的终端适配》</a>
<strong>优点：</strong></p>
<p><strong>缺点：</strong></p>
<h3>7、伪类 + transform 实现</h3>
<p>对于老项目，有没有什么办法能兼容1px的尴尬问题了，个人认为伪类+transform是比较完美的方法了。原理是把原先元素的 border 去掉，然后利用 :before 或者 :after 重做 border ，并 transform 的 scale 缩小一半，原先的元素相对定位，新做的 border 绝对定位。</p>
<p>单条border样式设置：</p>
<p>&nbsp;</p>
<pre><code>.scale-1px{
position: relative;
border:none;
}
.scale-1px:after{
content: &#39;&#39;;
position: absolute;
bottom: 0;
background: #000;
width: 100%;
height: 1px;
-webkit-transform: scaleY(0.5);
transform: scaleY(0.5);
-webkit-transform-origin: 0 0;
transform-origin: 0 0;
}
</code></pre>
<p>四条boder样式设置:</p>
<pre><code>.scale-1px{
position: relative;
margin-bottom: 20px;
border:none;
}
.scale-1px:after{
content: &#39;&#39;;
position: absolute;
top: 0;
left: 0;
border: 1px solid #000;
-webkit-box-sizing: border-box;
box-sizing: border-box;
width: 200%;
height: 200%;
-webkit-transform: scale(0.5);
transform: scale(0.5);
-webkit-transform-origin: left top;
transform-origin: left top;
}
</code></pre>
<p>最好在使用前也判断一下，结合 JS 代码，判断是否 Retina 屏：</p>
<pre><code>if(window.devicePixelRatio &amp;&amp; devicePixelRatio &gt;= 2){
document.querySelector(&#39;ul&#39;).className = &#39;scale-1px&#39;;
}
</code></pre>
<p><strong>优点：</strong></p>
<ul>
<li>所有场景都能满足</li>
<li>支持圆角(伪类和本体类都需要加border-radius)</li>

</ul>
<p><strong>缺点：</strong></p>
<ul>
<li>对于已经使用伪类的元素(例如clearfix)，可能需要多层嵌套</li>

</ul>
</body>
</html>